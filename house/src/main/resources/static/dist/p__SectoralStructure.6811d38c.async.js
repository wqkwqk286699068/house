(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[106],{LP5C:function(e,t,a){"use strict";a.r(t);a("IzEo");var n,i,r,l,s=a("bx4M"),o=(a("14J3"),a("BMrR")),d=(a("O3gP"),a("lrIw")),c=(a("jCWc"),a("kPKH")),u=(a("5NDa"),a("5rEg")),m=a("jehZ"),p=a.n(m),f=(a("+L6B"),a("2/Rp")),h=(a("2qtc"),a("kLXV")),y=a("2Taf"),g=a.n(y),v=a("vZ4D"),b=a.n(v),D=a("MhPg"),S=a.n(D),k=a("l4Ni"),j=a.n(k),M=a("ujKo"),E=a.n(M),O=(a("OaEy"),a("2fM7")),N=(a("nRaC"),a("5RzL")),V=(a("y8nQ"),a("Vl3Y")),C=a("q1tI"),F=a.n(C),w=a("MuoO"),I=a("zHco"),R=a("LLXN"),x=a("CkN6"),B=a("HZnN"),z=a("vDqi"),q=a.n(z),J=(a("Qyje"),a("Aeqt"));function X(e){var t=P();return function(){var a,n=E()(e);if(t){var i=E()(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return j()(this,a)}}function P(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}var L=V["a"].Item,T=N["a"].TreeNode,H=O["a"].Option,A="",K=(n=Object(w["connect"])(function(e){var t=e.sectoralstructuremodel,a=e.loading;return{sectoralstructuremodel:t,loading:a.models.sectoralstructuremodel}}),i=V["a"].create(),n(r=i((l=function(e){S()(a,e);var t=X(a);function a(e){var n;return g()(this,a),n=t.call(this,e),n.columns=[{title:Object(R["formatMessage"])({id:"dept.no"}),dataIndex:"id"},{title:Object(R["formatMessage"])({id:"dept.name"}),dataIndex:"userCode"}],n.handleSearch=function(e){var t=n.props,a=t.dispatch,i=t.form;i.validateFields(function(e,t){a({type:"sectoralstructuremodel/getDept",payload:{name:t.Name}})})},n.delete=function(e){var t=n.props.dispatch;A="1"===e.iflag?"0":"1",t({type:"sectoralstructuremodel/deleteByDeptId",payload:{id:e.id,iflag:A}}).then(function(){var e=n.props.sectoralstructuremodel.msg;if(0===e.code){h["a"].success({title:e.msg}),n.handleCancel(),t({type:"sectoralstructuremodel/getDept"});var a=n.props.DataSource;n.setState({DataSource:a}),n.setState({nameValidate:!1,id:""})}else h["a"].info({title:e.msg})})},n.addXiaJiModal=function(e){n.setState({nameValidate:!1,id:"",name:""});var t=""+e.id,a=n.props,i=a.form,r=a.dispatch,l=i.resetFields;l(),r({type:"sectoralstructuremodel/getDeptById",payload:{id:t}}).then(function(){var t=n.props.sectoralstructuremodel.Datas;n.setState({visible:!0,addDisplayName:"none",updateDisplayName:"none",addXiaJiDisplayName:"block",biaoqian:"".concat(Object(R["formatMessage"])({id:"dept.addxiaji"})),Datas:t,id:e.id,tip:"".concat(Object(R["formatMessage"])({id:"dept.xiajiname"}))})})},n.showModal=function(e){n.setState({nameValidate:!1,id:""});var t=n.props.form,a=t.resetFields;a(),n.setState({visible:!0,updateDisplayName:"none",addDisplayName:"block",addXiaJiDisplayName:"none",biaoqian:"".concat(Object(R["formatMessage"])({id:"dept.addziyuan"})),tip:"".concat(Object(R["formatMessage"])({id:"dept.name"}))})},n.updateModal=function(e){n.setState({nameValidate:!1,id:"",name:""});var t=n.props.form,a=t.resetFields;a();var i=n.props.dispatch;i({type:"sectoralstructuremodel/getDeptById",payload:{id:e.id}}).then(function(){var t=n.props.sectoralstructuremodel.Datas;n.setState({visible:!0,addDisplayName:"none",updateDisplayName:"block",addXiaJiDisplayName:"none",biaoqian:"".concat(Object(R["formatMessage"])({id:"dept.updateziyuan"})),Datas:t,id:e.id,tip:"".concat(Object(R["formatMessage"])({id:"dept.name"}))})})},n.updateMenu=function(e){var t=n.props,a=t.dispatch,i=t.form,r=n.state,l=r.nameValidate,s=r.id;i.validateFields(function(e,t){var r=""+t.parentId;t.name&&r||n.onBlurName(),t.name&&r?e||l||a({type:"sectoralstructuremodel/updateDept",payload:{name:t.name,parentId:r,id:s}}).then(function(){var e=n.props.sectoralstructuremodel.msg;if(0===e.code){h["a"].success({title:e.msg}),n.handleCancel(),a({type:"sectoralstructuremodel/getDept"});var t=n.props.DataSource;n.setState({DataSource:t}),i.setFieldsValue({name:"",parentId:""}),n.setState({nameValidate:!1,id:""});var r=i.resetFields;r()}else h["a"].info({title:e.msg})}):n.onBlurName()})},n.addMenu=function(e){var t=n.props,a=t.dispatch,i=t.form,r=n.state.nameValidate;i.validateFields(function(e,t){var l=""+t.parentId;t.name&&l||n.onBlurName(),t.name&&l?e||r||a({type:"sectoralstructuremodel/addDept",payload:{name:t.name,parentId:l,item:"0"}}).then(function(){var e=n.props.sectoralstructuremodel.msg;if(0===e.code){h["a"].success({title:e.msg}),n.handleCancel(),a({type:"sectoralstructuremodel/getDept"}),i.setFieldsValue({name:"",parentId:""}),n.setState({nameValidate:!1,id:""});var t=i.resetFields;t()}else h["a"].info({title:e.msg})}):n.onBlurName()})},n.addXiaji=function(e){var t=n.props,a=t.dispatch,i=t.form,r=n.state.nameValidate;i.validateFields(function(e,t){var l=""+t.parentId;t.name&&l||n.onBlurName(),t.name&&l?e||r||a({type:"sectoralstructuremodel/addDept",payload:{name:t.name,parentId:l,item:"1"}}).then(function(){var e=n.props.sectoralstructuremodel.msg;if(0===e.code){h["a"].success({title:e.msg}),n.handleCancel(),a({type:"sectoralstructuremodel/getDept"});var t=n.props.DataSource;n.setState({DataSource:t}),i.setFieldsValue({name:"",parentId:""}),n.setState({nameValidate:!1,id:""});var r=i.resetFields;r()}else h["a"].info({title:e.msg})}):n.onBlurName()})},n.state={selectedRows:[],load:!1,visible:!1,updateDisplayName:"none",addDisplayName:"none",biaoqian:"",nameValidate:!1,id:"",permsValidate:!1,urlValidate:!1,addXiaJiDisplayName:"none",Datas:[],tip:"",dataSource:[]},n}return b()(a,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"sectoralstructuremodel/queryDept"})}},{key:"componentWillReceiveProps",value:function(e){this.setState({DataSource:e.datalist})}},{key:"onBlurName",value:function(){var e=this,t=this.props.form;t.validateFields(["name"],{},function(t,a){if(a){if(void 0!==a.name)return a.name?void e.setState({nameValidate:!1}):void e.setState({nameValidate:!0});e.setState({nameValidate:!0})}})}},{key:"onBlurUrl",value:function(){var e=this,t=this.props.form;t.validateFields(["url"],{},function(t,a){if(a){if(void 0!==a.url)return a.url?void e.setState({urlValidate:!1}):void e.setState({urlValidate:!0});e.setState({urlValidate:!0})}})}},{key:"onBlurPerms",value:function(){var e=this,t=this.props.form;t.validateFields(["perms"],{},function(t,a){if(a){if(void 0!==a.perms)return a.perms?void e.setState({permsValidate:!1}):void e.setState({permsValidate:!0});e.setState({permsValidate:!0})}})}},{key:"handleOk",value:function(){var e=this;this.setState({load:!0}),setTimeout(function(){e.setState({load:!1,visible:!1})},3e3)}},{key:"handleCancel",value:function(){this.setState({visible:!1})}},{key:"modal",value:function(){var e=this,t=this.props,a=t.form.getFieldDecorator,n=t.sectoralstructuremodel.DataSource,i={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:12},md:{span:10}}},r=this.state,l=r.biaoqian,s=r.visible,o=r.load,d=r.nameValidate,c=r.id,m=r.Datas,y=r.addXiaJiDisplayName,g=r.updateDisplayName,v=r.addDisplayName,b=r.tip,D=[{id:0,name:"\u6839\u76ee\u5f55",children:n}],S="",k="";void 0!==m&&m.length>0&&(l==="".concat(Object(R["formatMessage"])({id:"dept.updateziyuan"}))&&(S=m[0].name),k=m[0].parentId);var j=function e(t){return t.map(function(t){var a=t.id,n=t.name,i=t.children;return i?F.a.createElement(T,{title:n,key:a,value:a},e(i)):F.a.createElement(T,{title:n,key:a,value:a})})},M=l==="".concat(Object(R["formatMessage"])({id:"dept.addziyuan"}))?0:l==="".concat(Object(R["formatMessage"])({id:"dept.updateziyuan"}))?k:c;return F.a.createElement(h["a"],{ref:"modal1",title:l,visible:s,onOk:this.handleOk.bind(this),onCancel:this.handleCancel.bind(this),style:{minWidth:200,minHeight:500,top:20},footer:[F.a.createElement(f["a"],{key:"back",size:"large",onClick:this.handleCancel.bind(this),style:{color:"black"}},Object(R["formatMessage"])({id:"userlist.cannel"})),F.a.createElement(f["a"],{key:"add",type:"primary",htmlType:"submit",size:"large",loading:o,style:{display:v,float:"right",backgroundColor:"#3D73FE"},onClick:this.addMenu.bind(this)},Object(R["formatMessage"])({id:"userlist.true"})),F.a.createElement(f["a"],{key:"update",type:"primary",htmlType:"submit",size:"large",loading:o,style:{display:g,float:"right",backgroundColor:"#3D73FE"},onClick:this.updateMenu.bind(this)},Object(R["formatMessage"])({id:"userlist.true"})),F.a.createElement(f["a"],{key:"update",type:"primary",htmlType:"submit",size:"large",loading:o,style:{display:y,float:"right",backgroundColor:"#3D73FE"},onClick:this.addXiaji.bind(this)},Object(R["formatMessage"])({id:"userlist.true"}))]},F.a.createElement("footer",null,F.a.createElement(V["a"],null,F.a.createElement(L,p()({},i,{label:F.a.createElement(R["FormattedMessage"],{id:"dept.shangjidept"})}),a("parentId",{initialValue:M,rules:[{required:!0}]})(F.a.createElement(N["a"],{disabled:!0,style:{width:250},dropdownStyle:{maxHeight:400,overflow:"auto"}},j(D)))),F.a.createElement(L,p()({},i,{label:b,validateStatus:d?"error":"",help:d?b!=="".concat(Object(R["formatMessage"])({id:"dept.xiajiname"}))?"".concat(Object(R["formatMessage"])({id:"dept.deptnamenotnull1"})):"".concat(Object(R["formatMessage"])({id:"dept.notnull"})):""}),a("name",{initialValue:S,rules:[{required:!0}]})(F.a.createElement(u["a"],{style:{width:250},placeholder:b!=="".concat(Object(R["formatMessage"])({id:"dept.xiajiname"}))?Object(R["formatMessage"])({id:"dept.inputname1"}):Object(R["formatMessage"])({id:"dept.inputxiaji"}),onBlur:function(){e.onBlurName()},onFocus:function(){e.setState({nameValidate:!1})}}))))))}},{key:"handleChange",value:function(e){var t=this,a=[];a.length=0,q.a.get("".concat(J["a"],"/enterprise/management/getCompanyName"),{params:{name:e}}).then(function(e){if(null!=e.data&&e.data.length>0)for(var n=0;n<e.data.length;n++)a.push(F.a.createElement(H,{key:e.data[n]},e.data[n]));else a.push(F.a.createElement(H,{key:Object(R["formatMessage"])({id:"jindiao.JwReconciliation.null"}),disabled:!0},Object(R["formatMessage"])({id:"jindiao.JwReconciliation.null"})));t.setState({dataSource:a})}).catch(function(e){})}},{key:"renderRiskAssembly",value:function(){var e=this,t=this.props.form.getFieldDecorator,a=this.state.dataSource;return F.a.createElement("div",null,F.a.createElement(V["a"],{layout:"inline"},F.a.createElement(o["a"],{gutter:{sm:4,lg:20,xl:12}},F.a.createElement(c["a"],{xl:18,lg:12,sm:24}),F.a.createElement(c["a"],{xl:4,lg:12,sm:24},F.a.createElement(L,null,t("Name")(F.a.createElement(d["a"],{ref:function(t){return e.input=t},dataSource:a,onChange:this.handleChange.bind(this),placeholder:Object(R["formatMessage"])({id:"dept.inputname1"})})))),F.a.createElement(c["a"],{xl:2,lg:12,sm:24},F.a.createElement(L,null,F.a.createElement(B["a"],{authority:"sectoralstructure:search"},F.a.createElement(f["a"],{style:{top:"2.5px",height:32,backgroundColor:"#3D73FE"},type:"primary",size:"large",onClick:this.handleSearch.bind(this)},Object(R["formatMessage"])({id:"role.select"}))))))))}},{key:"render",value:function(){var e=this.state.selectedRows,t=this.props,a=t.sectoralstructuremodel.DataSource,n=t.loading;return F.a.createElement(I["a"],null,F.a.createElement(s["a"],null,this.renderRiskAssembly(),F.a.createElement(x["a"],{bordered:!0,rowKey:function(e){return e.id},selectedRows:e,loading:n,data:{list:a,pagination:{}},columns:this.columns,onSelectRow:null,rowSelection:null,indentSize:30,pagination:!1})),this.modal())}}]),a}(C["PureComponent"]),r=l))||r)||r);t["default"]=K}}]);