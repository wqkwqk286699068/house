(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{cyud:function(e,t,a){"use strict";a.r(t);a("IzEo");var r,o,s,d,n=a("bx4M"),i=(a("5Dmo"),a("3S7+")),l=a("eHn4"),u=a.n(l),c=(a("5NDa"),a("5rEg")),p=a("jehZ"),f=a.n(p),m=(a("+L6B"),a("2/Rp")),w=(a("O3gP"),a("lrIw")),h=(a("2qtc"),a("kLXV")),g=a("2Taf"),v=a.n(g),y=a("vZ4D"),C=a.n(y),b=a("MhPg"),V=a.n(b),S=a("l4Ni"),z=a.n(S),q=a("ujKo"),P=a.n(q),O=(a("B9cy"),a("Ol7k")),M=(a("y8nQ"),a("Vl3Y")),j=a("q1tI"),E=a.n(j),B=a("MuoO"),F=a("LLXN"),k=a("zHco"),x=a("vDqi"),A=a.n(x),Z=(a("Qyje"),a("Aeqt")),N=a("HZnN"),R=a("KM9J"),_=a.n(R);a("qkbj");function D(e){var t=U();return function(){var a,r=P()(e);if(t){var o=P()(this).constructor;a=Reflect.construct(r,arguments,o)}else a=r.apply(this,arguments);return z()(this,a)}}function U(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}M["a"].create;var L=M["a"].Item,Y=O["a"].Sider;function T(e){for(var t=str.split(""),a=!0,r=1;r<t.length-1;r++){var o=t[r-1].charCodeAt(),s=t[r].charCodeAt(),d=t[r+1].charCodeAt();d-s==1&&s-o==1&&(a=!1)}return a}var I=(r=Object(B["connect"])(function(e){var t=e.info,a=e.loading;return{currentUser:t.currentUser,loading:a.models.info}}),o=M["a"].create(),r(s=o((d=function(e){V()(a,e);var t=D(a);function a(){var e;v()(this,a);for(var r=arguments.length,o=new Array(r),s=0;s<r;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o)),e.state={btnText:"".concat(Object(F["formatMessage"])({id:"info.userName.queryyzm"})),secounds:59,liked:!1,autoCompleteResult:[],dataSource:[],isClick:!0,userValidate:!1,yzmValidate:!1,pwdValidate:!1,qPwdValidate:!1,oldPwdValidate:!1,qPwd:"",user:"",pamas:[],pwd:""},e.handleSubmit=function(t){var a=e.props,r=a.dispatch,o=a.form,s=e.state,d=s.userValidate,n=s.yzmValidate,i=s.pwdValidate,l=s.qPwdValidate,u=s.oldPwdValidate,c=s.pamas;t.preventDefault(),o.validateFieldsAndScroll(function(t,a){if((a.userCode||a.yzm||a.password||a.oldpassword||a.querenpassword)&&(e.onBlurUser(),e.onBlurYzm(),e.onBlurOldPwd(),e.onBlurPwd(),e.onBlurNextPwd()),!a.userCode||!a.yzm||!a.password||!a.oldpassword||!a.querenpassword)return e.onBlurUser(),e.onBlurYzm(),e.onBlurOldPwd(),e.onBlurPwd(),void e.onBlurNextPwd();if(!t&&!d&&!n&&!i&&!l&&!u){var o={userCode:"admin"===a.userCode.toLowerCase()?c.userCode:a.userCode,password:a.password,yzm:a.yzm,oldpassword:a.oldpassword};r({type:"info/updatePwd",payload:o})}})},e.handleChange=function(t){e.setState({dataSource:!t||t.indexOf("@")>=0?[]:["".concat(t,"@gmail.com"),"".concat(t,"@163.com"),"".concat(t,"@qq.com"),"".concat(t,"@aliyun.com")]})},e.onChangeYzm=function(t){var a=e.props.form;"admin"===a.getFieldValue("userCode")?e.setState({pamas:{userCode:"ge_is_fly@aliyun.com".toLowerCase()}},function(){e.xiuGaiPwd()}):e.setState({pamas:{userCode:a.getFieldValue("userCode")}},function(){e.xiuGaiPwd()})},e.xiuGaiPwd=function(){var t=e.state,a=t.secounds,r=t.userValidate,o=t.pamas,s=t.form,d=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;if(o){if(!(void 0!==o.userCode&&o.userCode.length>0)){h["a"].info({title:"".concat(Object(F["formatMessage"])({id:"info.userName.required"}))});var n=s.resetFields;return n("userCode"),currentUser.userCode="",void s.setFieldsValue({userCode:""})}if(!d.test(o.userCode)){h["a"].info({title:"".concat(Object(F["formatMessage"])({id:"info.userName.truerequired"}))});var i=s.resetFields;return i("userCode"),currentUser.userCode="",void s.setFieldsValue({userCode:""})}e.setState({userValidate:!1})}r||A.a.get("".concat(Z["a"],"/account/info/getYzm?userCode=").concat(o.userCode)).then(function(t){if(0===t.data.code)e.setState({liked:!0}),59===a&&e.sendCode(),h["a"].success({title:t.data.msg});else if(1===t.data.code){h["a"].error({title:t.data.msg});var r=s.resetFields;r("userCode"),s.setFieldsValue({userCode:""})}})},e.sendCode=function(){var t=e.state.secounds,a=setInterval(function(){e.setState({secounds:t--},function(){t<=-1&&(clearInterval(a),e.setState({liked:!1,secounds:59}))})},1e3)},e}return C()(a,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e({type:"info/fetch"})}},{key:"onBlurUser",value:function(){var e=this,t=this.props.form;t.validateFields(["userCode"],{},function(t,a){var r=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/;if(a){if(void 0!==a.userCode&&0!==a.userCode.length)return"admin"===a.userCode||r.test(a.userCode)?void e.setState({userValidate:!1}):void e.setState({userValidate:!0,user:"".concat(Object(F["formatMessage"])({id:"info.userName.truerequired"}))});e.setState({userValidate:!0,user:"".concat(Object(F["formatMessage"])({id:"info.userName.required"}))})}e.setState({userValidate:!0,user:"".concat(Object(F["formatMessage"])({id:"info.userName.required"}))})})}},{key:"onBlurYzm",value:function(){var e=this,t=this.props.form;t.validateFields(["yzm"],{},function(t,a){if(a){if(a.yzm&&4===a.yzm.length)return void e.setState({yzmValidate:!1});e.setState({yzmValidate:!0})}})}},{key:"onBlurOldPwd",value:function(){var e=this,t=this.props.form;t.validateFields(["oldpassword"],{},function(t,a){if(a){if(a.oldpassword&&a.oldpassword.length>=0)return void e.setState({oldPwdValidate:!1});e.setState({oldPwdValidate:!0})}})}},{key:"onBlurPwd",value:function(){var e=this,t=this.props.form;t.validateFields(["password"],{},function(t,a){if(a){if(a.password){var r=new RegExp("(?=.*[0-9])(?=.*[a-zA-Z])(?=.*[^a-zA-Z0-9]).{8,20}");return r.test(a.password)&&T(a.password)?void e.setState({pwdValidate:!1}):void e.setState({pwdValidate:!0,pwd:"".concat(Object(F["formatMessage"])({id:"app.not.pwd"}))})}e.setState({pwdValidate:!0,pwd:"".concat(Object(F["formatMessage"])({id:"app.setting.newpwd"}))})}else e.setState({pwdValidate:!0,pwd:"".concat(Object(F["formatMessage"])({id:"app.setting.newpwd"}))})})}},{key:"onBlurNextPwd",value:function(){var e=this,t=this.props.form;t.validateFields(["querenpassword"],{},function(a,r){t.validateFields(["password"],{},function(t,a){if(r&&a){if(r.querenpassword){if(a.password&&a.password===r.querenpassword){var o=new RegExp("(?=.*[0-9])(?=.*[a-zA-Z])(?=.*[^a-zA-Z0-9]).{8,20}");return o.test(r.querenpassword)&&T(r.password)?void e.setState({qPwdValidate:!1}):void e.setState({qPwdValidate:!0,qPwd:"".concat(Object(F["formatMessage"])({id:"app.not.pwd"}))})}return void e.setState({qPwdValidate:!0,qPwd:"".concat(Object(F["formatMessage"])({id:"app.notpwd"}))})}if(a.password)return void e.setState({qPwdValidate:!0,qPwd:"".concat(Object(F["formatMessage"])({id:"app.input.newpwd"}))});e.setState({qPwdValidate:!0,qPwd:"".concat(Object(F["formatMessage"])({id:"app.confirm.newpwd"}))})}})})}},{key:"render",value:function(){var e,t=this,a=this.props.currentUser,r=this.props,o=r.form.getFieldDecorator,s=r.yzm,d=r.loading,l=this.state,p=l.dataSource,h=l.userValidate,g=l.yzmValidate,v=l.pwdValidate,y=l.qPwdValidate,C=l.oldPwdValidate,b=l.qPwd,V=l.liked,S=l.secounds,z=l.btnText,q=l.user,P=l.pwd,j={labelCol:{xs:{span:24},sm:{span:7}},wrapperCol:{xs:{span:24},sm:{span:12},md:{span:10}}},B={wrapperCol:{xs:{span:24,offset:0},sm:{span:10,offset:7}}};return E.a.createElement(k["a"],null,E.a.createElement(n["a"],{bordered:!1},E.a.createElement(M["a"],{onSubmit:this.handleSubmit,style:{marginTop:8}},E.a.createElement(L,f()({},j,{label:E.a.createElement(F["FormattedMessage"],{id:"info.loginName"}),validateStatus:h?"error":"",help:h?q:""}),E.a.createElement(O["a"],null,E.a.createElement(Y,{width:"60%",style:{backgroundColor:"white"}},o("userCode",{initialValue:a.userCode,rules:[{required:!0}]})(E.a.createElement(w["a"],{dataSource:p,onChange:this.handleChange,placeholder:Object(F["formatMessage"])({id:"info.loginName"}),style:{height:42},onBlur:function(){t.onBlurUser()},onFocus:function(){t.setState({userValidate:!1})}}))),E.a.createElement(Y,{style:{backgroundColor:"white"},width:"2%"}),E.a.createElement(Y,{style:{backgroundColor:"white"},width:"38%"},E.a.createElement(N["a"],{authority:"account:info:updatepass:getyzm"},E.a.createElement(m["a"],{disabled:V,style:{marginLeft:4},onClick:this.onChangeYzm},V?"".concat(S).concat(Object(F["formatMessage"])({id:"app.miaohou"})):z))))),E.a.createElement(L,f()({loading:d},j,{label:Object(F["formatMessage"])({id:"info.verification-code.placeholder"}),validateStatus:g?"error":"",help:g?"".concat(Object(F["formatMessage"])({id:"app.not.captcha"})):""}),o("yzm",{initialValue:s&&s.yzm,rules:[{required:!0}]})(E.a.createElement(c["a"],{id:"yzm",autocomplete:"new-text",placeholder:Object(F["formatMessage"])({id:"info.verification-code.placeholder"}),style:{width:"60%",height:32},onBlur:function(){t.onBlurYzm()},onFocus:function(){t.setState({yzmValidate:!1})}}))),E.a.createElement(L,f()({},j,{label:Object(F["formatMessage"])({id:"info.old.password"}),validateStatus:C?"error":"",help:C?"".concat(Object(F["formatMessage"])({id:"validation.password.old.required"})):""}),o("oldpassword",{rules:[{required:!0}]})(E.a.createElement(c["a"],{id:"password",autocomplete:"new-password",type:"password",placeholder:Object(F["formatMessage"])({id:"info.old.password"}),style:{width:"60%",height:32},onBlur:function(){t.onBlurOldPwd()},onFocus:function(){t.setState({oldPwdValidate:!1})}}))),E.a.createElement(L,f()({},j,{label:Object(F["formatMessage"])({id:"info.new.password"}),validateStatus:v?"error":"",help:v?P:""}),o("password",{rules:[{required:!0}]})(E.a.createElement("div",null,E.a.createElement(c["a"],(e={id:"password",autocomplete:"new-password",type:"password",style:{float:"left"},placeholder:Object(F["formatMessage"])({id:"app.setting.newpwd"})},u()(e,"style",{width:"60%",height:32}),u()(e,"onBlur",function(){t.onBlurPwd()}),u()(e,"onFocus",function(){t.setState({pwdValidate:!1})}),e)),E.a.createElement(i["a"],{placement:"leftTop",style:{padding:16},title:"".concat(Object(F["formatMessage"])({id:"app.rule"}))},E.a.createElement("img",{style:{width:"20px",float:"right",paddingTop:"10px",marginRight:136},src:_.a}))))),E.a.createElement(L,f()({},j,{label:Object(F["formatMessage"])({id:"info.new.password.sure"}),validateStatus:y?"error":"",help:y?b:""}),o("querenpassword",{rules:[{required:!0}]})(E.a.createElement(c["a"],{type:"password",placeholder:Object(F["formatMessage"])({id:"app.input.newpwd"}),style:{width:"60%",height:32},onBlur:function(){t.onBlurNextPwd()},onFocus:function(){t.setState({qPwdValidate:!1})}}))),E.a.createElement(L,B,E.a.createElement(N["a"],{authority:"account:info:updatepass:submit"},E.a.createElement(m["a"],{type:"primary",style:{width:100,marginTop:"5%",marginLeft:"10%"},onClick:this.handleSubmit.bind(this)},E.a.createElement(F["FormattedMessage"],{id:"info.submit"})))))))}}]),a}(j["PureComponent"]),s=d))||s)||s);t["default"]=I}}]);